<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nitterå®ä¾‹æµ‹è¯•å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 14px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-button {
            padding: 12px 24px;
            background: white;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #666;
            transition: all 0.3s;
        }

        .tab-button.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .instance-list {
            margin-top: 20px;
        }

        .instance-item {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .instance-item:hover {
            border-color: #667eea;
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.1);
        }

        .instance-info {
            flex: 1;
        }

        .instance-info h3 {
            color: #333;
            margin-bottom: 5px;
        }

        .instance-info p {
            color: #666;
            font-size: 14px;
        }

        .instance-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            margin-top: 8px;
        }

        .status-online {
            background: #d1fae5;
            color: #065f46;
        }

        .status-offline {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-testing {
            background: #dbeafe;
            color: #1e40af;
        }

        .tweet-list {
            display: grid;
            gap: 20px;
        }

        .tweet-item {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s;
        }

        .tweet-item:hover {
            border-color: #667eea;
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.1);
        }

        .tweet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .tweet-author {
            font-weight: 600;
            color: #667eea;
            font-size: 16px;
        }

        .tweet-date {
            color: #666;
            font-size: 12px;
        }

        .tweet-content {
            color: #333;
            line-height: 1.6;
            margin-bottom: 12px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .tweet-link {
            display: inline-block;
            color: #667eea;
            text-decoration: none;
            font-size: 14px;
            margin-top: 8px;
        }

        .tweet-link:hover {
            text-decoration: underline;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .error {
            background: #fee2e2;
            border: 2px solid #ef4444;
            color: #991b1b;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .success {
            background: #d1fae5;
            border: 2px solid #10b981;
            color: #065f46;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .quick-test {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .quick-test h3 {
            color: #0c4a6e;
            margin-bottom: 15px;
        }

        .quick-test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state svg {
            width: 64px;
            height: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¦ Nitterå®ä¾‹æµ‹è¯•å·¥å…·</h1>
            <p>ç®¡ç†å’Œæµ‹è¯•Nitterå®ä¾‹ï¼ŒæŸ¥çœ‹æ¨æ–‡å†…å®¹</p>
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('instances')">å®ä¾‹ç®¡ç†</button>
            <button class="tab-button" onclick="switchTab('tweets')">æ¨æ–‡æŸ¥çœ‹</button>
        </div>

        <!-- å®ä¾‹ç®¡ç†æ ‡ç­¾é¡µ -->
        <div id="instances-tab" class="tab-content active">
            <h2>Nitterå®ä¾‹ç®¡ç†</h2>
            
            <form id="instance-form" onsubmit="addInstance(event)">
                <div class="form-group">
                    <label for="instance-url">å®ä¾‹URL *</label>
                    <input type="text" id="instance-url" placeholder="https://your-nitter-service.railway.app" required>
                </div>
                <div class="form-group">
                    <label for="instance-name">å®ä¾‹åç§°</label>
                    <input type="text" id="instance-name" placeholder="ä¾‹å¦‚ï¼šRailway Nitterå®ä¾‹">
                </div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">æ·»åŠ å®ä¾‹</button>
                    <button type="button" class="btn btn-secondary" onclick="testAllInstances()">æµ‹è¯•æ‰€æœ‰å®ä¾‹</button>
                </div>
            </form>

            <div id="message-area"></div>

            <div class="instance-list" id="instance-list">
                <!-- å®ä¾‹åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <!-- æ¨æ–‡æŸ¥çœ‹æ ‡ç­¾é¡µ -->
        <div id="tweets-tab" class="tab-content">
            <h2>æ¨æ–‡æŸ¥çœ‹</h2>

            <div class="quick-test">
                <h3>å¿«é€Ÿæµ‹è¯•</h3>
                <p style="margin-bottom: 15px; color: #666;">å¿«é€Ÿæµ‹è¯• @OpenAI å’Œ @elonmusk çš„æ¨æ–‡</p>
                <div class="quick-test-buttons">
                    <button class="btn btn-primary" onclick="loadTweets('OpenAI')">åŠ è½½ @OpenAI æ¨æ–‡</button>
                    <button class="btn btn-primary" onclick="loadTweets('elonmusk')">åŠ è½½ @elonmusk æ¨æ–‡</button>
                </div>
            </div>

            <form id="tweet-form" onsubmit="loadCustomTweets(event)">
                <div class="form-group">
                    <label for="username">Twitterç”¨æˆ·å</label>
                    <input type="text" id="username" placeholder="ä¾‹å¦‚ï¼šOpenAI, elonmusk" required>
                </div>
                <div class="form-group">
                    <label for="instance-select">é€‰æ‹©Nitterå®ä¾‹</label>
                    <select id="instance-select" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                        <option value="">-- è¯·é€‰æ‹©å®ä¾‹ --</option>
                    </select>
                </div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary">åŠ è½½æ¨æ–‡</button>
                    <button type="button" class="btn btn-secondary" onclick="clearTweets()">æ¸…ç©ºåˆ—è¡¨</button>
                </div>
            </form>

            <div id="tweet-message-area"></div>

            <div class="tweet-list" id="tweet-list">
                <div class="empty-state">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                    </svg>
                    <p>é€‰æ‹©ä¸€ä¸ªå®ä¾‹å¹¶è¾“å…¥ç”¨æˆ·åæ¥åŠ è½½æ¨æ–‡</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å­˜å‚¨å®ä¾‹åˆ—è¡¨
        let instances = JSON.parse(localStorage.getItem('nitter-instances') || '[]');

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            renderInstances();
            updateInstanceSelect();
        });

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tab) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + '-tab').classList.add('active');
        }

        // æ·»åŠ å®ä¾‹
        function addInstance(event) {
            event.preventDefault();
            
            const url = document.getElementById('instance-url').value.trim();
            const name = document.getElementById('instance-name').value.trim() || url;

            // éªŒè¯URLæ ¼å¼
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                showMessage('è¯·è¾“å…¥æœ‰æ•ˆçš„URLï¼ˆä»¥http://æˆ–https://å¼€å¤´ï¼‰', 'error');
                return;
            }

            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
            if (instances.some(inst => inst.url === url)) {
                showMessage('è¯¥å®ä¾‹å·²å­˜åœ¨', 'error');
                return;
            }

            const instance = {
                id: Date.now().toString(),
                url: url.replace(/\/$/, ''), // ç§»é™¤æœ«å°¾æ–œæ 
                name: name,
                status: 'unknown'
            };

            instances.push(instance);
            saveInstances();
            renderInstances();
            updateInstanceSelect();
            
            document.getElementById('instance-form').reset();
            showMessage('å®ä¾‹æ·»åŠ æˆåŠŸï¼', 'success');
        }

        // åˆ é™¤å®ä¾‹
        function deleteInstance(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå®ä¾‹å—ï¼Ÿ')) {
                instances = instances.filter(inst => inst.id !== id);
                saveInstances();
                renderInstances();
                updateInstanceSelect();
                showMessage('å®ä¾‹å·²åˆ é™¤', 'success');
            }
        }

        // æµ‹è¯•å®ä¾‹
        async function testInstance(id) {
            const instance = instances.find(inst => inst.id === id);
            if (!instance) return;

            // æ›´æ–°çŠ¶æ€ä¸ºæµ‹è¯•ä¸­
            instance.status = 'testing';
            renderInstances();

            try {
                // æµ‹è¯•ä¸»é¡µ
                const response = await fetch(instance.url, {
                    method: 'GET',
                    mode: 'cors',
                    headers: {
                        'Accept': 'text/html'
                    }
                });

                if (response.ok) {
                    instance.status = 'online';
                    showMessage(`å®ä¾‹ ${instance.name} æµ‹è¯•æˆåŠŸï¼`, 'success');
                } else {
                    instance.status = 'offline';
                    showMessage(`å®ä¾‹ ${instance.name} æµ‹è¯•å¤±è´¥ï¼šHTTP ${response.status}`, 'error');
                }
            } catch (error) {
                instance.status = 'offline';
                showMessage(`å®ä¾‹ ${instance.name} æµ‹è¯•å¤±è´¥ï¼š${error.message}`, 'error');
            }

            saveInstances();
            renderInstances();
        }

        // æµ‹è¯•æ‰€æœ‰å®ä¾‹
        async function testAllInstances() {
            if (instances.length === 0) {
                showMessage('æ²¡æœ‰å¯æµ‹è¯•çš„å®ä¾‹', 'error');
                return;
            }

            showMessage('æ­£åœ¨æµ‹è¯•æ‰€æœ‰å®ä¾‹...', 'success');
            
            for (const instance of instances) {
                await testInstance(instance.id);
                // æ·»åŠ å»¶è¿Ÿé¿å…è¯·æ±‚è¿‡å¿«
                await new Promise(resolve => setTimeout(resolve, 500));
            }

            showMessage('æ‰€æœ‰å®ä¾‹æµ‹è¯•å®Œæˆï¼', 'success');
        }

        // æ¸²æŸ“å®ä¾‹åˆ—è¡¨
        function renderInstances() {
            const list = document.getElementById('instance-list');
            
            if (instances.length === 0) {
                list.innerHTML = '<div class="empty-state"><p>è¿˜æ²¡æœ‰æ·»åŠ å®ä¾‹ï¼Œè¯·åœ¨ä¸Šæ–¹æ·»åŠ ä¸€ä¸ªNitterå®ä¾‹</p></div>';
                return;
            }

            list.innerHTML = instances.map(instance => `
                <div class="instance-item">
                    <div class="instance-info">
                        <h3>${escapeHtml(instance.name)}</h3>
                        <p>${escapeHtml(instance.url)}</p>
                        <span class="instance-status status-${instance.status}">
                            ${getStatusText(instance.status)}
                        </span>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-success" onclick="testInstance('${instance.id}')">æµ‹è¯•</button>
                        <button class="btn btn-danger" onclick="deleteInstance('${instance.id}')">åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }

        // æ›´æ–°å®ä¾‹é€‰æ‹©ä¸‹æ‹‰æ¡†
        function updateInstanceSelect() {
            const select = document.getElementById('instance-select');
            select.innerHTML = '<option value="">-- è¯·é€‰æ‹©å®ä¾‹ --</option>' +
                instances.map(inst => 
                    `<option value="${escapeHtml(inst.url)}">${escapeHtml(inst.name)}</option>`
                ).join('');
        }

        // è·å–çŠ¶æ€æ–‡æœ¬
        function getStatusText(status) {
            const statusMap = {
                'online': 'åœ¨çº¿',
                'offline': 'ç¦»çº¿',
                'testing': 'æµ‹è¯•ä¸­...',
                'unknown': 'æœªæµ‹è¯•'
            };
            return statusMap[status] || 'æœªçŸ¥';
        }

        // ä¿å­˜å®ä¾‹åˆ—è¡¨
        function saveInstances() {
            localStorage.setItem('nitter-instances', JSON.stringify(instances));
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message, type) {
            const area = document.getElementById('message-area');
            area.innerHTML = `<div class="${type}">${escapeHtml(message)}</div>`;
            setTimeout(() => {
                area.innerHTML = '';
            }, 5000);
        }

        // æ˜¾ç¤ºæ¨æ–‡æ¶ˆæ¯
        function showTweetMessage(message, type) {
            const area = document.getElementById('tweet-message-area');
            area.innerHTML = `<div class="${type}">${escapeHtml(message)}</div>`;
            setTimeout(() => {
                area.innerHTML = '';
            }, 5000);
        }

        // åŠ è½½æ¨æ–‡
        async function loadTweets(username) {
            if (instances.length === 0) {
                showTweetMessage('è¯·å…ˆæ·»åŠ è‡³å°‘ä¸€ä¸ªNitterå®ä¾‹', 'error');
                switchTab('instances');
                return;
            }

            // ä½¿ç”¨ç¬¬ä¸€ä¸ªåœ¨çº¿å®ä¾‹ï¼Œå¦‚æœæ²¡æœ‰åœ¨çº¿å®ä¾‹åˆ™ä½¿ç”¨ç¬¬ä¸€ä¸ª
            const instance = instances.find(inst => inst.status === 'online') || instances[0];
            await fetchTweets(instance.url, username);
        }

        // åŠ è½½è‡ªå®šä¹‰æ¨æ–‡
        async function loadCustomTweets(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const instanceUrl = document.getElementById('instance-select').value;

            if (!username) {
                showTweetMessage('è¯·è¾“å…¥ç”¨æˆ·å', 'error');
                return;
            }

            if (!instanceUrl) {
                showTweetMessage('è¯·é€‰æ‹©Nitterå®ä¾‹', 'error');
                return;
            }

            await fetchTweets(instanceUrl, username);
        }

        // è·å–æ¨æ–‡
        async function fetchTweets(instanceUrl, username) {
            const rssUrl = `${instanceUrl}/${username}/rss`;
            
            showTweetMessage('æ­£åœ¨åŠ è½½æ¨æ–‡...', 'success');
            
            const tweetList = document.getElementById('tweet-list');
            tweetList.innerHTML = '<div class="loading">æ­£åœ¨åŠ è½½æ¨æ–‡...</div>';

            // å°è¯•ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼ˆå¦‚æœå¯ç”¨ï¼‰
            const useProxy = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            const proxyUrl = useProxy ? `/api/rss?url=${encodeURIComponent(rssUrl)}` : null;

            try {
                let response;
                
                // å…ˆå°è¯•ç›´æ¥è¯·æ±‚
                try {
                    response = await fetch(rssUrl, {
                        method: 'GET',
                        mode: 'cors',
                        headers: {
                            'Accept': 'application/rss+xml, application/xml, text/xml'
                        }
                    });
                } catch (directError) {
                    // å¦‚æœç›´æ¥è¯·æ±‚å¤±è´¥ï¼ˆå¯èƒ½æ˜¯CORSï¼‰ï¼Œå°è¯•ä½¿ç”¨ä»£ç†
                    if (proxyUrl) {
                        console.log('ç›´æ¥è¯·æ±‚å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨ä»£ç†æœåŠ¡å™¨...');
                        response = await fetch(proxyUrl, {
                            method: 'GET',
                            headers: {
                                'Accept': 'application/rss+xml, application/xml, text/xml'
                            }
                        });
                    } else {
                        throw directError;
                    }
                }

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const xmlText = await response.text();
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(xmlText, 'text/xml');

                // æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯
                const error = xmlDoc.querySelector('parsererror');
                if (error) {
                    throw new Error('XMLè§£æé”™è¯¯ï¼š' + error.textContent);
                }

                // è§£æRSS
                const items = xmlDoc.querySelectorAll('item');
                
                if (items.length === 0) {
                    tweetList.innerHTML = '<div class="empty-state"><p>æ²¡æœ‰æ‰¾åˆ°æ¨æ–‡ï¼Œå¯èƒ½æ˜¯RSSè¿”å›ç©ºå†…å®¹æˆ–éœ€è¦Twitter session token</p></div>';
                    showTweetMessage('RSSè¿”å›ç©ºå†…å®¹ï¼Œå¯èƒ½éœ€è¦é…ç½®Twitter session token', 'error');
                    return;
                }

                const tweets = Array.from(items).map(item => {
                    const title = item.querySelector('title')?.textContent || '';
                    const link = item.querySelector('link')?.textContent || '';
                    const pubDate = item.querySelector('pubDate')?.textContent || '';
                    const description = item.querySelector('description')?.textContent || '';

                    return {
                        title,
                        link,
                        pubDate: formatDate(pubDate),
                        description: cleanTweetContent(description)
                    };
                });

                renderTweets(tweets, username);
                showTweetMessage(`æˆåŠŸåŠ è½½ ${tweets.length} æ¡æ¨æ–‡`, 'success');

            } catch (error) {
                console.error('Error fetching tweets:', error);
                let errorMessage = error.message;
                let suggestion = '';
                
                if (error.message.includes('CORS') || error.message.includes('Failed to fetch')) {
                    suggestion = '<br><br><small>ğŸ’¡ æç¤ºï¼šå¦‚æœé‡åˆ°CORSé”™è¯¯ï¼Œå¯ä»¥ï¼š<br>1. ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼ˆè¿è¡Œ <code>node proxy-server.js</code>ï¼‰<br>2. æˆ–ä½¿ç”¨æœ¬åœ°WebæœåŠ¡å™¨è®¿é—®æ­¤é¡µé¢</small>';
                }
                
                tweetList.innerHTML = `<div class="error">
                    <strong>åŠ è½½å¤±è´¥ï¼š</strong><br>
                    ${escapeHtml(errorMessage)}${suggestion}
                </div>`;
                showTweetMessage('åŠ è½½æ¨æ–‡å¤±è´¥ï¼š' + errorMessage, 'error');
            }
        }

        // æ¸²æŸ“æ¨æ–‡åˆ—è¡¨
        function renderTweets(tweets, username) {
            const tweetList = document.getElementById('tweet-list');
            
            if (tweets.length === 0) {
                tweetList.innerHTML = '<div class="empty-state"><p>æ²¡æœ‰æ¨æ–‡</p></div>';
                return;
            }

            tweetList.innerHTML = tweets.map(tweet => `
                <div class="tweet-item">
                    <div class="tweet-header">
                        <span class="tweet-author">@${escapeHtml(username)}</span>
                        <span class="tweet-date">${escapeHtml(tweet.pubDate)}</span>
                    </div>
                    <div class="tweet-content">${escapeHtml(tweet.description)}</div>
                    <a href="${escapeHtml(tweet.link)}" target="_blank" class="tweet-link">æŸ¥çœ‹åŸæ–‡ â†’</a>
                </div>
            `).join('');
        }

        // æ¸…ç©ºæ¨æ–‡åˆ—è¡¨
        function clearTweets() {
            document.getElementById('tweet-list').innerHTML = '<div class="empty-state"><p>é€‰æ‹©ä¸€ä¸ªå®ä¾‹å¹¶è¾“å…¥ç”¨æˆ·åæ¥åŠ è½½æ¨æ–‡</p></div>';
            document.getElementById('tweet-message-area').innerHTML = '';
        }

        // æ¸…ç†æ¨æ–‡å†…å®¹
        function cleanTweetContent(content) {
            // ç§»é™¤HTMLæ ‡ç­¾
            const div = document.createElement('div');
            div.innerHTML = content;
            return div.textContent || div.innerText || '';
        }

        // æ ¼å¼åŒ–æ—¥æœŸ
        function formatDate(dateString) {
            if (!dateString) return 'æœªçŸ¥æ—¶é—´';
            try {
                const date = new Date(dateString);
                return date.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            } catch (e) {
                return dateString;
            }
        }

        // HTMLè½¬ä¹‰
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>
